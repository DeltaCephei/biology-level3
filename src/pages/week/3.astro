---
/* ==========================================================================
   Week 3 — Simple Animal Responses
   AS 91603: Responses of plants and animals to their external environment

   Dedicated page with full content: taxis vs kinesis explained from scratch,
   NZ species examples, interactive quiz, video embeds, and extension material.
   ========================================================================== */

import BaseLayout from '../../layouts/BaseLayout.astro';

const base = import.meta.env.BASE_URL;
---

<BaseLayout title="Week 3: Simple Animal Responses — Dr Eliot's Level 3 Biology">

  <div class="week-page">

    <!-- ====================================================================
         Week Header
         ==================================================================== -->
    <header class="week-header fade-in-up">
      <div class="week-header__meta">
        <a href={base} class="back-link">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
            <path d="M13 8H3M7 4L3 8l4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Back to Dashboard
        </a>
        <span class="term-badge">Term 1</span>
      </div>

      <div class="week-header__title-row">
        <span class="week-number">Week 3</span>
        <h1 class="week-title">Simple Animal Responses</h1>
      </div>

      <div class="week-header__badges">
        <span class="badge badge--standard">AS 91603</span>
        <span class="badge badge--desc">Responses of plants and animals to their external environment</span>
      </div>
    </header>


    <!-- ====================================================================
         Quick Navigation
         ==================================================================== -->
    <nav class="week-nav fade-in-up" aria-label="Page sections">
      <a href="#core-content" class="week-nav__link">Core Content</a>
      <a href="#stimuli" class="week-nav__link">Stimuli &amp; Prefixes</a>
      <a href="#nz-examples" class="week-nav__link">NZ Examples</a>
      <a href="#quiz" class="week-nav__link">Test Yourself</a>
      <a href="#how-to-watch" class="week-nav__link">How to Watch</a>
      <a href="#videos" class="week-nav__link">Videos</a>
      <a href="#go-further" class="week-nav__link">Go Further</a>
    </nav>


    <!-- ====================================================================
         Two-Column Layout
         ==================================================================== -->
    <div class="week-layout">

      <!-- ================================================================
           Main Content
           ================================================================ -->
      <main class="week-main">


        <!-- ——————————————————————————————————————————————————————————————
             Section 1: Core Content — Taxis and Kinesis
             —————————————————————————————————————————————————————————————— -->
        <section id="core-content" class="content-section fade-in-up">
          <h2>Taxis and Kinesis</h2>

          <p>
            Animals constantly respond to changes in their environment. Some of these responses
            are <strong>innate</strong> — hardwired into the animal's genes, not learned through
            experience. Innate behaviours are:
          </p>

          <ul class="feature-list">
            <li><strong>Heritable</strong> — passed from parents to offspring</li>
            <li><strong>Intrinsic</strong> — present even in animals raised in isolation</li>
            <li><strong>Stereotypic</strong> — performed the same way by all individuals of the species</li>
            <li><strong>Immutable</strong> — not changed by experience or learning</li>
          </ul>

          <p>
            Two types of simple innate response are <strong>taxis</strong> and <strong>kinesis</strong>.
            Both involve the whole organism moving in response to a stimulus, but they work in
            fundamentally different ways.
          </p>

          <!-- Taxis -->
          <h3>Taxis <span class="pronunciation">(plural: taxes)</span></h3>

          <p>
            A taxis is a <strong>directional</strong> movement in response to a stimulus. The animal
            detects where the stimulus is coming from and moves towards it
            (<strong>positive taxis</strong>) or away from it (<strong>negative taxis</strong>).
          </p>

          <p>
            The key feature: the animal can determine the <em>direction</em> of the stimulus.
          </p>

          <div class="key-concept">
            <h4>How do animals detect direction?</h4>

            <div class="concept-pair">
              <div class="concept-card concept-card--taxis">
                <h5>Klinotaxis</h5>
                <p>
                  The animal has receptor(s) in <strong>one region</strong> of its body. It moves its
                  body from side to side, comparing stimulus intensity from different directions,
                  then orients accordingly.
                </p>
                <div class="concept-example">
                  <span class="example-label">Example</span>
                  A blowfly maggot swings its head left and right, comparing light intensity.
                  It turns away from the brighter side — <em>negative phototaxis via klinotaxis</em>.
                </div>
              </div>

              <div class="concept-card concept-card--taxis">
                <h5>Tropotaxis</h5>
                <p>
                  The animal has <strong>paired receptors</strong> (one on each side of its body) and
                  makes a <em>simultaneous</em> comparison of stimulus intensity.
                </p>
                <div class="concept-example">
                  <span class="example-label">Example</span>
                  A barnacle larva detects chemical concentration on both sides of its body at once,
                  swimming towards the higher concentration —
                  <em>positive chemotaxis via tropotaxis</em>.
                </div>
              </div>
            </div>
          </div>

          <!-- Kinesis -->
          <h3>Kinesis <span class="pronunciation">(plural: kineses)</span></h3>

          <p>
            A kinesis is a <strong>non-directional</strong> movement response. The animal
            <em>cannot</em> determine the direction of the stimulus. Instead, its pattern of
            movement changes depending on conditions:
          </p>

          <div class="key-concept">
            <div class="concept-pair">
              <div class="concept-card concept-card--kinesis">
                <h5>Orthokinesis</h5>
                <p>
                  The <strong>speed</strong> of movement changes with stimulus intensity.
                </p>
                <div class="concept-example">
                  <span class="example-label">Example</span>
                  A woodlouse moves faster in dry air and slower in humid air. It doesn't know
                  which direction the moisture is — it just moves quickly until it happens to find
                  somewhere damp, then slows down and stays there.
                </div>
              </div>

              <div class="concept-card concept-card--kinesis">
                <h5>Klinokinesis</h5>
                <p>
                  The <strong>rate of turning</strong> (direction changes) varies with stimulus
                  intensity.
                </p>
                <div class="concept-example">
                  <span class="example-label">Example</span>
                  A flatworm turns more frequently in bright light. In the dark, it moves in
                  straighter lines. The result: it ends up spending more time in dark areas —
                  not because it moved towards them, but because it kept changing direction
                  until it stumbled into shade.
                </div>
              </div>
            </div>
          </div>

          <!-- Summary box -->
          <div class="summary-box">
            <h4>Why does the difference matter?</h4>
            <p>
              The distinction tells us about the animal's <strong>sensory capabilities</strong>:
            </p>
            <ul>
              <li>
                An animal performing <strong>taxis</strong> has receptors sophisticated enough
                to detect the <em>direction</em> of a stimulus
              </li>
              <li>
                An animal performing <strong>kinesis</strong> has receptors that detect stimulus
                <em>intensity</em> but not direction
              </li>
            </ul>
            <p>
              Both achieve the same survival outcome — the animal ends up in a more favourable
              environment — but through different mechanisms.
              <strong>In exams, you need to explain the mechanism, not just the outcome.</strong>
            </p>
          </div>
        </section>


        <!-- ——————————————————————————————————————————————————————————————
             Section 2: The Eight Stimuli and Their Prefixes
             —————————————————————————————————————————————————————————————— -->
        <section id="stimuli" class="content-section fade-in-up">
          <h2>The Eight Stimuli and Their Prefixes</h2>

          <p>
            Each stimulus has a prefix that you combine with "taxis" or "kinesis" to name the
            response. For example, a directional response to light is <strong>phototaxis</strong>;
            a non-directional response to moisture is <strong>hydrokinesis</strong>.
          </p>

          <div class="table-wrapper">
            <table class="stimuli-table">
              <thead>
                <tr>
                  <th>Stimulus</th>
                  <th>Prefix</th>
                  <th>Example response</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Light</td>
                  <td><strong>Photo-</strong></td>
                  <td>Moth flying towards a porch light (positive phototaxis)</td>
                </tr>
                <tr>
                  <td>Temperature</td>
                  <td><strong>Thermo-</strong></td>
                  <td>Tuatara moving to bask in sun (positive thermotaxis)</td>
                </tr>
                <tr>
                  <td>Gravity</td>
                  <td><strong>Gravi- / Geo-</strong></td>
                  <td>Plant roots growing downward (positive gravitaxis)</td>
                </tr>
                <tr>
                  <td>Chemicals</td>
                  <td><strong>Chemo-</strong></td>
                  <td>Pāua larvae swimming towards algae chemicals (positive chemotaxis)</td>
                </tr>
                <tr>
                  <td>Touch</td>
                  <td><strong>Thigmo-</strong></td>
                  <td>Barnacle larva cementing to rock on contact (thigmokinesis)</td>
                </tr>
                <tr>
                  <td>Water / Moisture</td>
                  <td><strong>Hydro-</strong></td>
                  <td>Earthworm moving towards damp soil (positive hydrotaxis)</td>
                </tr>
                <tr>
                  <td>Water current</td>
                  <td><strong>Rheo-</strong></td>
                  <td>Longfin eel swimming upstream (positive rheotaxis)</td>
                </tr>
                <tr>
                  <td>Food / Nutrients</td>
                  <td><strong>Tropho-</strong></td>
                  <td>Organism moving towards a food source (positive trophotaxis)</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>


        <!-- ——————————————————————————————————————————————————————————————
             Section 3: NZ & Global Examples
             —————————————————————————————————————————————————————————————— -->
        <section id="nz-examples" class="content-section fade-in-up">
          <h2>New Zealand Examples</h2>

          <p>
            These examples use native NZ species to illustrate taxis and kinesis. Several of
            these are backed by published research — the kind of detail that can strengthen
            an Excellence answer.
          </p>

          <div class="examples-grid">

            <!-- Glow-worm -->
            <div class="example-card">
              <img src={`${base}/images/species/glowworm.jpg`} alt="NZ glow-worm (Arachnocampa luminosa) in a cave" class="example-card__img" loading="lazy" />
              <div class="example-card__header">
                <h4>NZ Glow-worm</h4>
                <span class="example-card__latin">Arachnocampa luminosa</span>
                <span class="response-badge response-badge--taxis">Positive phototaxis (prey)</span>
              </div>
              <div class="example-card__body">
                <p>
                  Glow-worm larvae produce bioluminescent light in caves and bush banks.
                  Their prey — midges, moths, and caddisflies — exhibit <strong>positive
                  phototaxis</strong>, flying directly towards the blue-green glow. The insects
                  get trapped in sticky silk threads hanging below.
                </p>
                <p class="example-card__detail">
                  Research at Waitomo Caves confirmed that adhesive traps placed over glow-worms
                  caught significantly more invertebrates than control traps. The glow-worm
                  exploits the innate phototactic response of its prey.
                </p>
              </div>
            </div>

            <!-- Tree wētā -->
            <div class="example-card">
              <img src={`${base}/images/species/tree-weta.jpg`} alt="Tree wētā (Hemideina thoracica) on a leaf" class="example-card__img" loading="lazy" />
              <div class="example-card__header">
                <h4>Tree Wētā</h4>
                <span class="example-card__latin">Hemideina thoracica</span>
                <span class="response-badge response-badge--taxis">Negative phototaxis</span>
              </div>
              <div class="example-card__body">
                <p>
                  Tree wētā are nocturnal foragers that actively move <strong>away</strong> from
                  light. Research at Maungatautari Ecological Island using LED lights and infrared
                  cameras found an <strong>87.5% reduction</strong> in tree wētā activity in
                  illuminated areas.
                </p>
                <p class="example-card__detail">
                  Male wētā showed the strongest avoidance — they accounted for 85% of visits
                  and almost completely avoided lit sites. This negative phototaxis reduces
                  predation risk during night-time foraging.
                </p>
              </div>
            </div>

            <!-- Pāua -->
            <div class="example-card">
              <img src={`${base}/images/species/paua.jpg`} alt="Pāua (Haliotis iris) shell showing iridescent nacre" class="example-card__img" loading="lazy" />
              <div class="example-card__header">
                <h4>Pāua (Abalone) Larvae</h4>
                <span class="example-card__latin">Haliotis iris</span>
                <span class="response-badge response-badge--taxis">Positive chemotaxis</span>
              </div>
              <div class="example-card__body">
                <p>
                  Pāua larvae in NZ coastal waters swim towards <strong>chemicals released by
                  coralline algae</strong> on rocks. When tested with five species of coralline
                  algae, all induced more than 88% of larvae to attach within one day and more
                  than 80% to metamorphose within three days.
                </p>
                <p class="example-card__detail">
                  This positive chemotaxis ensures larvae settle on suitable substrate near
                  adult feeding habitat — a critical step in pāua population sustainability.
                </p>
              </div>
            </div>

            <!-- Longfin eel -->
            <div class="example-card">
              <img src={`${base}/images/species/longfin-eel.jpg`} alt="NZ longfin eel (Anguilla dieffenbachii) feeding" class="example-card__img" loading="lazy" />
              <div class="example-card__header">
                <h4>Longfin Eel / Tuna</h4>
                <span class="example-card__latin">Anguilla dieffenbachii</span>
                <span class="response-badge response-badge--taxis">Positive rheotaxis</span>
              </div>
              <div class="example-card__body">
                <p>
                  Endemic to Aotearoa New Zealand. Juvenile longfin eels (glass eels) returning
                  from the ocean swim <strong>against the river current</strong> as they migrate
                  upstream into freshwater — a positive rheotaxis. Adults later migrate thousands
                  of kilometres to the tropical Pacific to spawn, likely using chemotaxis
                  (olfactory navigation) to find ancestral spawning grounds.
                </p>
                <p class="example-card__detail">
                  Longfin eels have well-developed tube-shaped nostrils and an exceptional
                  sense of smell, supporting both rheotactic and chemotactic responses at
                  different life stages.
                </p>
              </div>
            </div>

            <!-- Peripatus -->
            <div class="example-card">
              <img src={`${base}/images/species/peripatus.jpg`} alt="Peripatus (Peripatoides novaezealandiae) velvet worm on a tree" class="example-card__img" loading="lazy" />
              <div class="example-card__header">
                <h4>Peripatus / Ngaokeoke</h4>
                <span class="example-card__latin">Peripatoides novaezealandiae</span>
                <span class="response-badge response-badge--kinesis">Hygrokinesis (orthokinesis)</span>
              </div>
              <div class="example-card__body">
                <p>
                  NZ velvet worms <strong>cannot regulate water loss</strong> — they lack both a
                  waxy cuticle and closeable breathing pores (spiracles). They move
                  <strong>faster in dry conditions</strong> and slow down in humid conditions
                  under rotting logs and leaf litter.
                </p>
                <p class="example-card__detail">
                  This is orthokinesis — the speed of movement changes with humidity, but the
                  peripatus has no ability to detect <em>which direction</em> is damper. It
                  simply moves quickly until it reaches a moist microhabitat, then stays put.
                  A life-or-death response given their extreme vulnerability to desiccation.
                </p>
              </div>
            </div>

            <!-- Cave wētā -->
            <div class="example-card">
              <img src={`${base}/images/species/cave-weta.jpg`} alt="Cave wētā in a tunnel near the Slate River, NZ" class="example-card__img" loading="lazy" />
              <div class="example-card__header">
                <h4>Cave Wētā</h4>
                <span class="example-card__latin">Rhaphidophoridae</span>
                <span class="response-badge response-badge--kinesis">Hygrokinesis + klinokinesis</span>
              </div>
              <div class="example-card__body">
                <p>
                  Found in caves, hollow trees, and rock crevices. Cave wētā show <strong>both
                  orthokinesis and klinokinesis</strong>: in dry, bright conditions they move
                  <strong>faster</strong> and <strong>change direction more often</strong>. In
                  dark, damp conditions they slow down and move in straighter lines.
                </p>
                <p class="example-card__detail">
                  Research found a 71.7% reduction in cave wētā observations under artificial
                  light. The combination of increased speed (orthokinesis) and increased turning
                  (klinokinesis) in unfavourable conditions keeps them in the damp, dark habitats
                  they need.
                </p>
              </div>
            </div>

          </div>

          <p class="photo-credit">
            Photos: Wikimedia Commons (CC BY / CC BY-SA). Markrosenrosen, James O'Hanlon,
            James St. John, Funcs, Tony Wills, Schwede66.
          </p>

          <!-- Exam-relevant organisms -->
          <div class="exam-tip">
            <h4>Exam Corner: Past Paper Organisms</h4>
            <p>
              These three organisms appeared in the 2015 NCEA exam for AS 91603. Know them well:
            </p>
            <ul>
              <li>
                <strong>Blowfly maggot</strong> — negative phototaxis via <em>klinotaxis</em>
                (swings head to compare light)
              </li>
              <li>
                <strong>Barnacle larva</strong> — positive chemotaxis via <em>tropotaxis</em>
                (paired receptors compare concentration simultaneously)
              </li>
              <li>
                <strong>Woodlouse / slater</strong> — <em>orthokinesis</em>
                (moves faster in dry air, slower in humid air)
              </li>
            </ul>
          </div>
        </section>


        <!-- ——————————————————————————————————————————————————————————————
             Section 4: Test Yourself — Interactive Scenario Quiz
             —————————————————————————————————————————————————————————————— -->
        <section id="quiz" class="content-section fade-in-up">
          <h2>Test Yourself</h2>
          <p>
            Read each scenario and decide: is the animal performing <strong>taxis</strong> or
            <strong>kinesis</strong>? Then identify the specific type. There are 10 questions
            — see how you go.
          </p>

          <!-- Quiz container — populated by JS -->
          <div class="quiz-container" id="quiz-container">
            <div class="quiz-start" id="quiz-start">
              <button class="btn btn--primary" id="quiz-start-btn">Start Quiz</button>
            </div>

            <!-- Active quiz state (hidden until started) -->
            <div class="quiz-active" id="quiz-active" hidden>
              <div class="quiz-progress">
                <div class="quiz-progress__bar">
                  <div class="quiz-progress__fill" id="quiz-progress-fill"></div>
                </div>
                <span class="quiz-progress__text">
                  Question <span id="q-num">1</span> / <span id="q-total">10</span>
                </span>
              </div>

              <div class="quiz-scenario" id="quiz-scenario"></div>

              <div class="quiz-options" id="quiz-options"></div>

              <div class="quiz-feedback" id="quiz-feedback" hidden></div>

              <button class="btn btn--secondary quiz-next" id="quiz-next" hidden>
                Next
                <svg width="14" height="14" viewBox="0 0 16 16" fill="none" aria-hidden="true">
                  <path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>

            <!-- Results (hidden until complete) -->
            <div class="quiz-results" id="quiz-results" hidden>
              <h3>Your Results</h3>
              <div class="quiz-score">
                <span class="quiz-score__number" id="quiz-score-number">0</span>
                <span class="quiz-score__total">/ <span id="quiz-score-total">20</span></span>
              </div>
              <p class="quiz-score__label" id="quiz-score-label"></p>
              <div class="quiz-review" id="quiz-review"></div>
              <button class="btn btn--primary" id="quiz-restart-btn">Try Again</button>
            </div>
          </div>
        </section>


        <!-- ——————————————————————————————————————————————————————————————
             Section 5: How to Watch Videos to Actually Learn
             —————————————————————————————————————————————————————————————— -->
        <section id="how-to-watch" class="content-section fade-in-up">
          <div class="section-header-with-audio">
            <h2>How to Watch Videos to Actually Learn</h2>
            <button class="audio-btn" id="how-to-watch-audio" title="Listen to Dr Eliot explain this">&#9654;</button>
          </div>
          <p>
            Research consistently shows that <strong>passively watching a video
            teaches you almost nothing</strong>. Students who just press play
            and let a video run perform barely better than students who never
            watched it at all. The difference comes from <em>what you do</em>
            while watching.
          </p>

          <div class="watch-tips-grid">
            <!-- Tip 1: Before -->
            <div class="watch-tip-card">
              <div class="watch-tip-card__icon">Before</div>
              <h4>Prime your brain first</h4>
              <p>
                Before you press play, read the description below each video
                and ask yourself: <em>"What do I already know about this? What
                am I expecting to learn?"</em> This activates your prior
                knowledge and gives your brain a framework to attach new
                information to. Researchers call this the
                <strong>pre-question effect</strong> — simply having a question
                in mind before you encounter information dramatically improves
                how much you remember.
              </p>
            </div>

            <!-- Tip 2: During — Pause -->
            <div class="watch-tip-card">
              <div class="watch-tip-card__icon">During</div>
              <h4>Pause and predict</h4>
              <p>
                Hit pause every 2–3 minutes. Before the video explains
                something, try to predict what comes next. After a key point,
                look away from the screen and say the idea back to yourself
                <em>in your own words</em>. If you can't, rewind and watch
                that section again. This is called <strong>retrieval
                practice</strong> — the act of pulling information out of your
                memory is what strengthens it, not the act of putting it in.
              </p>
            </div>

            <!-- Tip 3: During — Notes -->
            <div class="watch-tip-card">
              <div class="watch-tip-card__icon">During</div>
              <h4>Draw, don't just write</h4>
              <p>
                When you take notes, <strong>sketch diagrams</strong> alongside
                your words. Draw a woodlouse in a choice chamber. Draw arrows
                showing taxis vs kinesis movement patterns. This is called
                <strong>dual coding</strong> — combining words and visuals
                creates two separate memory traces, making the information far
                easier to recall later. A quick rough diagram beats three
                paragraphs of neat handwriting.
              </p>
            </div>

            <!-- Tip 4: During — Speed -->
            <div class="watch-tip-card">
              <div class="watch-tip-card__icon">During</div>
              <h4>Playback speed matters</h4>
              <p>
                Research shows that <strong>1.5× speed</strong> doesn't hurt
                comprehension for revision — your brain can keep up. But
                <strong>2× speed significantly reduces retention</strong> for
                new material. Rule of thumb: first time watching a topic, stick
                to 1× or 1.5×. Rewatching for revision? 1.5× is fine.
              </p>
            </div>

            <!-- Tip 5: After -->
            <div class="watch-tip-card">
              <div class="watch-tip-card__icon">After</div>
              <h4>Test yourself immediately</h4>
              <p>
                The moment the video ends, close your laptop lid (or flip your
                phone over) and write down everything you can remember. This
                is called a <strong>brain dump</strong>, and it's one of the
                most powerful study techniques that exists. Don't worry about
                getting it perfect — the effort of trying to recall is what
                builds the memory. Then check what you missed and focus your
                next study session on those gaps.
              </p>
            </div>

            <!-- Tip 6: After — Spacing -->
            <div class="watch-tip-card">
              <div class="watch-tip-card__icon">After</div>
              <h4>Space it out, don't binge</h4>
              <p>
                Watching all 12 videos in one sitting feels productive but
                produces very little lasting memory. The
                <strong>spacing effect</strong> shows that spreading your
                viewing across multiple days — even just 2–3 videos per
                session — leads to dramatically better long-term retention.
                A little forgetting between sessions is actually
                <em>desirable</em>; it makes the next review more effortful
                and therefore more effective.
              </p>
            </div>
          </div>

          <div class="summary-box">
            <strong>The bottom line:</strong> Watching a video is not studying.
            Watching a video while pausing, predicting, sketching, and
            self-testing <em>is</em> studying. The students who do best aren't
            the ones who watch the most videos — they're the ones who think
            the hardest while watching.
          </div>
        </section>


        <!-- ——————————————————————————————————————————————————————————————
             Section 6: Videos
             —————————————————————————————————————————————————————————————— -->
        <section id="videos" class="content-section fade-in-up">
          <h2>Videos</h2>

          <!-- ── Theory Explainers ── -->
          <h3>Theory Explainers</h3>

          <h4>Taxes and Kinesis — Miss Estruch</h4>
          <p>
            The best all-round overview. Covers both taxis and kinesis with clear
            diagrams, real examples, and A-level exam language that maps directly
            onto NCEA terminology.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/_-jAkT0QHM0"
              title="Taxes and Kinesis: Simple responses in organisms — Miss Estruch"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Taxis & Kinesis — bionerdery</h4>
          <p>
            A quick, focused recap if you just need a 3-minute refresher.
            Good for last-minute revision before a test.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/rRDovcEf_ks"
              title="Taxis & Kinesis — bionerdery"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>AP Biology Lab 11: Animal Behavior — Bozeman Science</h4>
          <p>
            Paul Andersen contrasts taxis and kinesis, then demonstrates a
            choice-chamber experiment with pill bugs. Shows how scientists
            actually collect and interpret behavioural data.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/jSKkecFzD50"
              title="AP Biology Lab 11: Animal Behavior — Bozeman Science"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Taxis (Animal Movement) — sci-ology</h4>
          <p>
            Focuses specifically on taxis — directional movement towards or away
            from a stimulus. Useful if you want to nail down the different
            types (photo-, chemo-, gravi-) with examples.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/n02SW9fs_VU"
              title="Taxis (Animal Movement) — sci-ology"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Kinesis (Animal Movement) — sci-ology</h4>
          <p>
            The companion video to the one above, covering kinesis —
            non-directional responses where organisms change speed or turning
            rate. Watch both for the full picture.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/AAJNaoYKMbA"
              title="Kinesis (Animal Movement) — sci-ology"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Taxis: Directional Movement in Organisms — Hussain Biology</h4>
          <p>
            A thorough 5-minute breakdown of taxis with clear visuals.
            Covers positive and negative responses to light, chemicals, and
            gravity with organism examples at each step.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/CVr23RWnkZE"
              title="Taxis: Directional Movement in Organisms — Hussain Biology"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <!-- ── Practicals & Choice Chambers ── -->
          <h3>Practicals & Choice Chambers</h3>

          <!-- Simulator callout -->
          <div class="simulator-callout">
            <div class="simulator-callout__text">
              <strong>Try the virtual choice chamber</strong> — select an organism, set conditions,
              and watch taxis and kinesis in action. Record your data just like a real practical.
            </div>
            <a href={`${base}/experiments/choice-chamber`} class="btn btn--primary simulator-callout__btn">
              Launch Simulator →
            </a>
          </div>

          <h4>Choice Chambers — Investigating Taxis in Invertebrates</h4>
          <p>
            Walks through the choice-chamber method step by step and explains
            what the results tell us about taxis and kinesis. A solid intro
            to the practical side of this topic.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/FC_RPbMXGm0"
              title="Choice Chambers — Investigating animal responses"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Woodlice Choice Chamber — Animated Science</h4>
          <p>
            An animated walkthrough of the classic woodlice choice-chamber
            experiment. Shows how to set up dry vs damp and light vs dark
            conditions, then interpret the results as kinesis and taxis.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/84QRiuVvz84"
              title="Woodlice Choice Chamber — Animated Science"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Choice Chamber Required Practical — Miss Estruch</h4>
          <p>
            A longer, detailed walkthrough of running the choice-chamber
            practical with maggots and woodlice. Covers method, results
            tables, and how to write up your findings for an exam answer.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/LG1cLm1jOG8"
              title="CHOICE CHAMBER Required Practical — Miss Estruch"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <!-- ── NZ Glow-worm Footage ── -->
          <h3>NZ Glow-worm Footage</h3>
          <p>
            These videos show <em>Arachnocampa luminosa</em> — the NZ glow-worm
            from your species cards above — in its natural cave habitat. The
            glow-worm's bioluminescence is a stunning example of how
            <strong>positive phototaxis</strong> in prey insects is exploited
            by a predator.
          </p>

          <h4>Glowworms in Motion — 4K Time-lapse</h4>
          <p>
            Award-winning footage by Stoked for Saturday, filmed over 30+ hours
            underground in NZ caves. 1.4 million views. Shows the scale of
            glow-worm colonies and the sticky silk threads they use to trap
            phototactic insects.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/JC41M7RPSec"
              title="Glowworms in Motion — 4K Time-lapse — Stoked for Saturday"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Glow Worm Caves of New Zealand in 360° — National Geographic</h4>
          <p>
            A 360° experience of the Waitomo caves from National Geographic.
            Drag to look around and get a sense of what it's like inside the
            cave system. Great for understanding the dark environment that
            makes the glow-worms' phototactic trap so effective.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/QjqGlLVIAtg"
              title="Glow Worm Caves of New Zealand in 360° — National Geographic"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <h4>Waitomo's Lights — Avatar in Real Life (4K)</h4>
          <p>
            The follow-up from Stoked for Saturday, filmed over 60 hours in the
            Waitomo cave system. Features underwater cave rivers and
            close-up shots of individual glow-worm threads.
          </p>
          <div class="video-wrapper">
            <iframe
              src="https://www.youtube.com/embed/AlLKjKgV5So"
              title="Waitomo's Lights — Avatar in Real Life — Stoked for Saturday"
              loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>

          <!-- Placeholder for Stream video -->
          <div class="stream-placeholder" id="stream-video">
            <h3>One Planet — David Attenborough</h3>
            <p class="placeholder-hint">
              Stream video link coming soon. You'll need your school email to access this.
            </p>
          </div>
        </section>


        <!-- ——————————————————————————————————————————————————————————————
             Section 6: Go Further
             —————————————————————————————————————————————————————————————— -->
        <section id="go-further" class="content-section fade-in-up">
          <h2>Go Further</h2>

          <p>
            Extension material for those who want to deepen their understanding or get
            ahead on exam preparation.
          </p>

          <div class="go-further-grid">

            <div class="go-further-card go-further-card--highlight">
              <h4>Choice Chamber Simulator</h4>
              <p>
                Run a virtual choice chamber experiment. Choose from 5 organisms, set light and
                moisture conditions, and observe taxis and kinesis in real time. Includes a
                chi-squared calculator to test your results.
              </p>
              <a
                href={`${base}/experiments/choice-chamber`}
                class="go-further-link"
              >
                Launch Simulator
                <svg width="14" height="14" viewBox="0 0 16 16" fill="none" aria-hidden="true">
                  <path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </a>
            </div>

            <div class="go-further-card">
              <h4>Past Paper Practice</h4>
              <p>
                Work through actual NCEA exam questions on taxis and kinesis. These have
                appeared in 2015, 2016, 2018, 2019, and 2020 papers.
              </p>
              <a
                href="https://www.nobraintoosmall.co.nz/html/senior_biology/NCEA3_biology_plants_and_animals.html"
                target="_blank"
                rel="noopener noreferrer"
                class="go-further-link"
              >
                No Brain Too Small — AS 91603 Resources
                <svg width="14" height="14" viewBox="0 0 16 16" fill="none" aria-hidden="true">
                  <path d="M5 3h8v8M13 3L3 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </a>
            </div>

            <div class="go-further-card">
              <h4>What Markers Look For</h4>
              <p>
                For Excellence in a taxis/kinesis question, you need to:
              </p>
              <ul>
                <li>Correctly identify the response type (taxis or kinesis)</li>
                <li>Name the specific mechanism (klinotaxis, tropotaxis, orthokinesis, klinokinesis)</li>
                <li>Explain <em>how</em> the mechanism works (not just what happens)</li>
                <li>Link the response to its <strong>adaptive advantage</strong> — why does this behaviour help the organism survive or reproduce?</li>
              </ul>
            </div>

            <div class="go-further-card">
              <h4>Textbook Readings</h4>
              <p class="placeholder-hint">
                Specific chapter and page references will be added here shortly.
                Check Teams Class Materials for the full book list.
              </p>
            </div>

          </div>
        </section>

      </main>


      <!-- ================================================================
           Sidebar
           ================================================================ -->
      <aside class="week-sidebar">

        <!-- Learning Objectives -->
        <div class="sidebar-card fade-in-up">
          <h3>Learning Objectives</h3>
          <ul class="objectives-list">
            <li class="objective-item">
              <span class="objective-checkbox" aria-hidden="true"></span>
              <span>Explain the difference between innate and learned behaviour</span>
            </li>
            <li class="objective-item">
              <span class="objective-checkbox" aria-hidden="true"></span>
              <span>Define and distinguish between taxis and kinesis</span>
            </li>
            <li class="objective-item">
              <span class="objective-checkbox" aria-hidden="true"></span>
              <span>Identify the eight stimuli and their prefixes</span>
            </li>
            <li class="objective-item">
              <span class="objective-checkbox" aria-hidden="true"></span>
              <span>Describe examples of positive and negative taxis in NZ species</span>
            </li>
            <li class="objective-item">
              <span class="objective-checkbox" aria-hidden="true"></span>
              <span>Explain how choice chambers investigate animal responses</span>
            </li>
            <li class="objective-item">
              <span class="objective-checkbox" aria-hidden="true"></span>
              <span>Use correct terminology: klinotaxis, tropotaxis, orthokinesis, klinokinesis</span>
            </li>
          </ul>
        </div>

        <!-- On This Page -->
        <div class="sidebar-card sidebar-card--sticky fade-in-up">
          <h3>On This Page</h3>
          <nav class="sidebar-toc" aria-label="Table of contents">
            <a href="#core-content" class="toc-link">Core Content</a>
            <a href="#stimuli" class="toc-link">Stimuli &amp; Prefixes</a>
            <a href="#nz-examples" class="toc-link">NZ Examples</a>
            <a href="#quiz" class="toc-link">Test Yourself</a>
            <a href="#how-to-watch" class="toc-link">How to Watch</a>
            <a href="#videos" class="toc-link">Videos</a>
            <a href="#go-further" class="toc-link">Go Further</a>
          </nav>
        </div>

        <!-- Textbook Readings -->
        <div class="sidebar-card fade-in-up">
          <h3>Textbook Readings</h3>
          <p class="placeholder-hint">
            Page references coming shortly — check Teams for the full book list.
          </p>
        </div>

      </aside>

    </div>
  </div>

</BaseLayout>


<style>
  /* ==========================================================================
     Week 3 Page Styles
     ========================================================================== */

  .week-page {
    max-width: 1120px;
    margin: 0 auto;
    padding: var(--space-6) var(--space-5) var(--space-8);
  }

  /* --------------------------------------------------------------------------
     Fade-in-up animation
     -------------------------------------------------------------------------- */
  .fade-in-up {
    opacity: 0;
    transform: translateY(24px);
    transition:
      opacity 0.6s cubic-bezier(0.23, 1, 0.32, 1),
      transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
  }

  .fade-in-up.is-visible {
    opacity: 1;
    transform: translateY(0);
  }


  /* ==========================================================================
     Week Header
     ========================================================================== */
  .week-header {
    margin-bottom: var(--space-6);
    padding-bottom: var(--space-6);
    border-bottom: 1px solid var(--border-subtle);
  }

  .week-header__meta {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--text-sm);
    color: var(--text-secondary);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .back-link:hover {
    color: var(--accent);
  }

  .term-badge {
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    font-family: var(--font-display);
    color: var(--text-muted);
    background: var(--surface-2);
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-full);
  }

  .week-header__title-row {
    margin-bottom: var(--space-3);
  }

  .week-number {
    display: block;
    font-family: var(--font-display);
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-bottom: var(--space-2);
  }

  .week-title {
    font-size: clamp(var(--text-2xl), 4vw, var(--text-4xl));
    font-weight: var(--weight-bold);
    line-height: var(--leading-tight);
  }

  .week-header__badges {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-3);
  }

  .badge {
    display: inline-flex;
    align-items: center;
    padding: var(--space-1) var(--space-3);
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    font-family: var(--font-display);
    border-radius: var(--radius-full);
    line-height: 1;
    white-space: nowrap;
  }

  .badge--standard {
    background: rgba(0, 255, 136, 0.1);
    color: var(--accent);
  }

  .badge--desc {
    background: transparent;
    color: var(--text-muted);
    padding: 0;
    font-weight: var(--weight-normal);
    font-family: var(--font-body);
    font-size: var(--text-sm);
  }


  /* ==========================================================================
     Quick Navigation Bar
     ========================================================================== */
  .week-nav {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-bottom: var(--space-6);
    padding: var(--space-3) var(--space-4);
    background: var(--surface-1);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-lg);
  }

  .week-nav__link {
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    color: var(--text-secondary);
    text-decoration: none;
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    transition:
      color var(--transition-fast),
      background var(--transition-fast);
  }

  .week-nav__link:hover {
    color: var(--accent);
    background: var(--accent-muted);
  }


  /* ==========================================================================
     Two-Column Layout
     ========================================================================== */
  .week-layout {
    display: grid;
    grid-template-columns: 1fr 280px;
    gap: var(--space-6);
    align-items: start;
  }

  @media (max-width: 900px) {
    .week-layout {
      grid-template-columns: 1fr;
    }
  }


  /* ==========================================================================
     Main Content Area
     ========================================================================== */
  .week-main {
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
  }

  .content-section {
    background: var(--surface-1);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
    scroll-margin-top: 80px;
  }

  .content-section h2 {
    font-size: var(--text-xl);
    margin-bottom: var(--space-4);
    color: var(--accent);
  }

  .content-section h3 {
    font-size: var(--text-lg);
    font-weight: var(--weight-semibold);
    margin-top: var(--space-5);
    margin-bottom: var(--space-3);
    color: var(--text-primary);
  }

  .content-section p {
    font-size: var(--text-base);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-3);
  }

  .content-section p:last-child {
    margin-bottom: 0;
  }

  .pronunciation {
    font-size: var(--text-sm);
    color: var(--text-muted);
    font-weight: var(--weight-normal);
    font-style: italic;
  }


  /* --------------------------------------------------------------------------
     Feature list (innate behaviour characteristics)
     -------------------------------------------------------------------------- */
  .feature-list {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
    padding-left: var(--space-4);
  }

  .feature-list li {
    font-size: var(--text-base);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    position: relative;
    padding-left: var(--space-4);
  }

  .feature-list li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0.65em;
    width: 6px;
    height: 6px;
    border-radius: var(--radius-full);
    background: var(--accent);
    opacity: 0.6;
  }


  /* --------------------------------------------------------------------------
     Key Concept boxes (taxis/kinesis mechanism cards)
     -------------------------------------------------------------------------- */
  .key-concept {
    margin: var(--space-4) 0;
  }

  .key-concept h4 {
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    margin-bottom: var(--space-3);
  }

  .concept-pair {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: var(--space-4);
  }

  .concept-card {
    background: var(--surface-2);
    border-radius: var(--radius-md);
    padding: var(--space-4);
    border-left: 3px solid var(--border-default);
  }

  .concept-card--taxis {
    border-left-color: var(--fluoro-cyan);
  }

  .concept-card--kinesis {
    border-left-color: var(--green-vivid);
  }

  .concept-card h5 {
    font-family: var(--font-display);
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    margin-bottom: var(--space-2);
  }

  .concept-card p {
    font-size: var(--text-sm);
    margin-bottom: var(--space-2);
  }

  .concept-example {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    background: var(--surface-1);
    padding: var(--space-3);
    border-radius: var(--radius-sm);
    margin-top: var(--space-2);
    line-height: var(--leading-relaxed);
  }

  .example-label {
    display: inline-block;
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    font-family: var(--font-display);
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    margin-bottom: var(--space-1);
  }


  /* --------------------------------------------------------------------------
     Summary box
     -------------------------------------------------------------------------- */
  .summary-box {
    background: var(--surface-2);
    border: 1px solid var(--accent);
    border-radius: var(--radius-md);
    padding: var(--space-5);
    margin-top: var(--space-5);
  }

  .summary-box h4 {
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--accent);
    margin-bottom: var(--space-3);
  }

  .summary-box ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-bottom: var(--space-3);
    padding-left: 0;
  }

  .summary-box li {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    padding-left: var(--space-4);
    position: relative;
  }

  .summary-box li::before {
    content: '→';
    position: absolute;
    left: 0;
    color: var(--accent);
  }


  /* ==========================================================================
     Stimuli Table
     ========================================================================== */
  .table-wrapper {
    overflow-x: auto;
    margin-top: var(--space-3);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-subtle);
  }

  .stimuli-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--text-sm);
  }

  .stimuli-table th,
  .stimuli-table td {
    text-align: left;
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--border-subtle);
  }

  .stimuli-table th {
    background: var(--surface-2);
    font-family: var(--font-display);
    font-weight: var(--weight-semibold);
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: var(--text-muted);
  }

  .stimuli-table td {
    color: var(--text-secondary);
  }

  .stimuli-table tr:last-child td {
    border-bottom: none;
  }

  .stimuli-table tr:hover td {
    background: var(--surface-2);
  }


  /* ==========================================================================
     NZ Examples Grid
     ========================================================================== */
  .examples-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--space-4);
    margin-bottom: var(--space-5);
  }

  .example-card {
    background: var(--surface-2);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    overflow: hidden;
    transition:
      transform var(--transition-base),
      box-shadow var(--transition-base);
  }

  .example-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
  }

  .example-card__img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    display: block;
  }

  .example-card__header {
    padding: var(--space-4);
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .example-card__header h4 {
    font-family: var(--font-display);
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    margin: 0;
  }

  .example-card__latin {
    font-size: var(--text-xs);
    font-style: italic;
    color: var(--text-muted);
  }

  .response-badge {
    display: inline-flex;
    align-self: flex-start;
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    font-family: var(--font-display);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    margin-top: var(--space-1);
  }

  .response-badge--taxis {
    background: rgba(0, 235, 255, 0.1);
    color: var(--fluoro-cyan);
  }

  .response-badge--kinesis {
    background: rgba(0, 255, 136, 0.1);
    color: var(--green-vivid);
  }

  .example-card__body {
    padding: var(--space-4);
  }

  .example-card__body p {
    font-size: var(--text-sm);
    margin-bottom: var(--space-2);
  }

  .example-card__detail {
    color: var(--text-muted) !important;
    font-size: var(--text-xs) !important;
    border-top: 1px solid var(--border-subtle);
    padding-top: var(--space-2);
    margin-top: var(--space-2) !important;
  }


  /* --------------------------------------------------------------------------
     Exam Tip
     -------------------------------------------------------------------------- */
  .photo-credit {
    font-size: var(--text-xs);
    color: var(--text-muted);
    opacity: 0.6;
    margin-bottom: var(--space-4);
  }

  .exam-tip {
    background: rgba(255, 110, 199, 0.06);
    border: 1px solid rgba(255, 110, 199, 0.2);
    border-radius: var(--radius-md);
    padding: var(--space-5);
  }

  .exam-tip h4 {
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--fluoro-pink);
    margin-bottom: var(--space-3);
  }

  .exam-tip p {
    font-size: var(--text-sm);
  }

  .exam-tip ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-top: var(--space-2);
    padding-left: 0;
  }

  .exam-tip li {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    padding-left: var(--space-4);
    position: relative;
  }

  .exam-tip li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0.65em;
    width: 6px;
    height: 6px;
    border-radius: var(--radius-full);
    background: var(--fluoro-pink);
    opacity: 0.6;
  }


  /* ==========================================================================
     Interactive Quiz
     ========================================================================== */
  .quiz-container {
    margin-top: var(--space-3);
  }

  .quiz-start {
    text-align: center;
    padding: var(--space-5);
  }

  /* Buttons */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-family: var(--font-display);
    font-weight: var(--weight-semibold);
    font-size: var(--text-base);
    padding: var(--space-3) var(--space-5);
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition:
      background var(--transition-fast),
      transform var(--transition-fast),
      box-shadow var(--transition-fast);
  }

  .btn:hover {
    transform: translateY(-1px);
  }

  .btn--primary {
    background: var(--accent);
    color: var(--surface-0);
  }

  .btn--primary:hover {
    box-shadow: var(--shadow-glow);
  }

  .btn--secondary {
    background: var(--surface-2);
    color: var(--text-primary);
    border: 1px solid var(--border-default);
  }

  .btn--secondary:hover {
    background: var(--surface-3);
  }

  /* Progress bar */
  .quiz-progress {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
  }

  .quiz-progress__bar {
    flex: 1;
    height: 6px;
    background: var(--surface-3);
    border-radius: var(--radius-full);
    overflow: hidden;
  }

  .quiz-progress__fill {
    height: 100%;
    background: var(--accent);
    border-radius: var(--radius-full);
    transition: width 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    width: 0%;
  }

  .quiz-progress__text {
    font-size: var(--text-xs);
    font-family: var(--font-mono);
    color: var(--text-muted);
    white-space: nowrap;
  }

  /* Scenario text */
  .quiz-scenario {
    font-size: var(--text-base);
    color: var(--text-primary);
    line-height: var(--leading-relaxed);
    padding: var(--space-4);
    background: var(--surface-2);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-4);
  }

  /* Options */
  .quiz-options {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
  }

  .quiz-option-btn {
    flex: 1;
    min-width: 140px;
    padding: var(--space-3) var(--space-4);
    font-family: var(--font-display);
    font-weight: var(--weight-semibold);
    font-size: var(--text-base);
    border: 2px solid var(--border-default);
    border-radius: var(--radius-md);
    background: var(--surface-1);
    color: var(--text-primary);
    cursor: pointer;
    transition:
      border-color var(--transition-fast),
      background var(--transition-fast),
      transform var(--transition-fast);
  }

  .quiz-option-btn:hover:not(:disabled) {
    border-color: var(--accent);
    background: var(--accent-muted);
    transform: translateY(-1px);
  }

  .quiz-option-btn:disabled {
    cursor: default;
    opacity: 0.5;
  }

  .quiz-option-btn.correct {
    border-color: var(--green-vivid);
    background: rgba(0, 255, 136, 0.1);
    color: var(--green-vivid);
  }

  .quiz-option-btn.incorrect {
    border-color: var(--fluoro-pink);
    background: rgba(255, 110, 199, 0.1);
    color: var(--fluoro-pink);
  }

  /* Feedback panel */
  .quiz-feedback {
    padding: var(--space-4);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-3);
    font-size: var(--text-sm);
    line-height: var(--leading-relaxed);
  }

  .quiz-feedback.correct {
    background: rgba(0, 255, 136, 0.08);
    border: 1px solid rgba(0, 255, 136, 0.2);
    color: var(--text-secondary);
  }

  .quiz-feedback.incorrect {
    background: rgba(255, 110, 199, 0.08);
    border: 1px solid rgba(255, 110, 199, 0.2);
    color: var(--text-secondary);
  }

  .quiz-feedback strong {
    color: var(--text-primary);
  }

  .quiz-next {
    margin-left: auto;
    display: flex;
  }

  /* Results */
  .quiz-results {
    text-align: center;
    padding: var(--space-5);
  }

  .quiz-results h3 {
    margin-top: 0;
  }

  .quiz-score {
    margin-bottom: var(--space-3);
  }

  .quiz-score__number {
    font-family: var(--font-display);
    font-size: var(--text-4xl);
    font-weight: var(--weight-bold);
    color: var(--accent);
  }

  .quiz-score__total {
    font-size: var(--text-xl);
    color: var(--text-muted);
  }

  .quiz-score__label {
    font-size: var(--text-base);
    color: var(--text-secondary);
    margin-bottom: var(--space-5);
  }

  .quiz-review {
    text-align: left;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-bottom: var(--space-5);
  }

  .quiz-review-item {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    font-size: var(--text-sm);
    color: var(--text-secondary);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-sm);
    background: var(--surface-2);
  }

  .quiz-review-item .dot {
    flex-shrink: 0;
    width: 8px;
    height: 8px;
    border-radius: var(--radius-full);
    margin-top: 6px;
  }

  .quiz-review-item .dot.green {
    background: var(--green-vivid);
  }

  .quiz-review-item .dot.red {
    background: var(--fluoro-pink);
  }


  /* ==========================================================================
     Audio Button
     ========================================================================== */
  .section-header-with-audio {
    display: flex;
    align-items: center;
    gap: var(--space-3);
  }

  .section-header-with-audio h2 {
    margin-bottom: 0;
  }

  .audio-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid var(--border-default);
    background: var(--surface-2);
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: var(--text-secondary);
  }

  .audio-btn:hover {
    border-color: var(--accent);
    background: rgba(0, 255, 136, 0.1);
    transform: scale(1.1);
  }

  .audio-btn.playing {
    border-color: var(--accent);
    background: var(--accent);
    color: var(--surface-1);
    animation: audio-pulse 1.5s ease-in-out infinite;
  }

  @keyframes audio-pulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.4); }
    50% { box-shadow: 0 0 0 8px rgba(0, 255, 136, 0); }
  }


  /* ==========================================================================
     How to Watch — Tips Grid
     ========================================================================== */
  .watch-tips-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-4);
    margin: var(--space-5) 0;
  }

  @media (max-width: 768px) {
    .watch-tips-grid {
      grid-template-columns: 1fr;
    }
  }

  .watch-tip-card {
    background: var(--surface-2);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    padding: var(--space-4);
  }

  .watch-tip-card__icon {
    display: inline-block;
    font-family: var(--font-display);
    font-size: var(--text-xs);
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--surface-1);
    background: var(--accent);
    padding: 0.15em 0.6em;
    border-radius: var(--radius-sm);
    margin-bottom: var(--space-2);
  }

  .watch-tip-card h4 {
    font-family: var(--font-display);
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    margin: 0 0 var(--space-2) 0;
  }

  .watch-tip-card p {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    margin: 0;
  }


  /* ==========================================================================
     Videos
     ========================================================================== */
  /* Video sub-group headings (h3) get a top divider after the first group */
  #videos h3:not(:first-of-type) {
    margin-top: var(--space-6);
    padding-top: var(--space-5);
    border-top: 1px solid var(--border-subtle);
  }

  /* Individual video titles */
  #videos h4 {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    margin-top: var(--space-5);
    margin-bottom: var(--space-2);
  }

  /* Tighten the description paragraph before each video */
  #videos h4 + p {
    margin-bottom: var(--space-3);
    color: var(--text-secondary);
    font-size: var(--text-sm);
    line-height: var(--leading-relaxed);
  }

  .video-wrapper {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    height: 0;
    overflow: hidden;
    border-radius: var(--radius-md);
    margin-bottom: var(--space-5);
    background: var(--surface-2);
  }

  .video-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
    border-radius: var(--radius-md);
  }

  .stream-placeholder {
    background: var(--surface-2);
    border: 1px dashed var(--border-default);
    border-radius: var(--radius-md);
    padding: var(--space-5);
  }

  .stream-placeholder h3 {
    margin-top: 0;
  }

  .placeholder-hint {
    font-size: var(--text-sm);
    color: var(--text-muted);
    font-style: italic;
  }


  /* ==========================================================================
     Go Further
     ========================================================================== */
  .go-further-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-4);
    margin-top: var(--space-3);
  }

  .go-further-card {
    background: var(--surface-2);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    padding: var(--space-5);
  }

  .go-further-card h4 {
    font-family: var(--font-display);
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    color: var(--text-primary);
    margin-bottom: var(--space-3);
  }

  .go-further-card p {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-3);
  }

  .go-further-card ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    padding-left: 0;
    margin: 0;
  }

  .go-further-card li {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
    padding-left: var(--space-4);
    position: relative;
  }

  .go-further-card li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0.65em;
    width: 5px;
    height: 5px;
    border-radius: var(--radius-full);
    background: var(--accent);
    opacity: 0.5;
  }

  .go-further-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--text-sm);
    font-weight: var(--weight-semibold);
    color: var(--accent);
    text-decoration: none;
    transition: gap var(--transition-fast);
  }

  .go-further-link:hover {
    gap: var(--space-3);
  }

  /* Highlighted go-further card (simulator) */
  .go-further-card--highlight {
    border-color: var(--accent);
    border-left: 3px solid var(--accent);
  }

  /* Simulator callout in the videos section */
  .simulator-callout {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-4);
    margin-bottom: var(--space-5);
    background: rgba(0, 255, 136, 0.06);
    border: 1px solid rgba(0, 255, 136, 0.2);
    border-radius: var(--radius-md);
  }

  .simulator-callout__text {
    flex: 1;
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
  }

  .simulator-callout__text strong {
    color: var(--text-primary);
  }

  .simulator-callout__btn {
    flex-shrink: 0;
    text-decoration: none;
    font-size: var(--text-sm);
    white-space: nowrap;
  }

  @media (max-width: 560px) {
    .simulator-callout {
      flex-direction: column;
      align-items: stretch;
    }
    .simulator-callout__btn {
      text-align: center;
      justify-content: center;
    }
  }


  /* ==========================================================================
     Sidebar
     ========================================================================== */
  .week-sidebar {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  .sidebar-card {
    background: var(--surface-1);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
  }

  .sidebar-card--sticky {
    position: sticky;
    top: 80px;
  }

  .sidebar-card h3 {
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    margin-bottom: var(--space-4);
    color: var(--text-primary);
  }

  /* Learning objectives */
  .objectives-list {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
  }

  .objective-item {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: var(--leading-relaxed);
  }

  .objective-checkbox {
    flex-shrink: 0;
    width: 18px;
    height: 18px;
    margin-top: 2px;
    border: 1.5px solid var(--border-default);
    border-radius: var(--radius-sm);
    background: var(--surface-2);
    transition:
      border-color var(--transition-fast),
      background var(--transition-fast);
  }

  .objective-item:hover .objective-checkbox {
    border-color: var(--accent);
  }

  /* Table of contents */
  .sidebar-toc {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .toc-link {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    text-decoration: none;
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    transition:
      color var(--transition-fast),
      background var(--transition-fast);
  }

  .toc-link:hover {
    color: var(--accent);
    background: var(--accent-muted);
  }


  /* ==========================================================================
     Responsive — Stagger animations
     ========================================================================== */
  .content-section:nth-child(1) { transition-delay: 0.05s; }
  .content-section:nth-child(2) { transition-delay: 0.10s; }
  .content-section:nth-child(3) { transition-delay: 0.15s; }
  .content-section:nth-child(4) { transition-delay: 0.20s; }
  .content-section:nth-child(5) { transition-delay: 0.25s; }
  .content-section:nth-child(6) { transition-delay: 0.30s; }

  .week-sidebar .sidebar-card:nth-child(1) { transition-delay: 0.10s; }
  .week-sidebar .sidebar-card:nth-child(2) { transition-delay: 0.15s; }
  .week-sidebar .sidebar-card:nth-child(3) { transition-delay: 0.20s; }

  @media (max-width: 560px) {
    .content-section {
      padding: var(--space-4);
    }
    .examples-grid {
      grid-template-columns: 1fr;
    }
    .concept-pair {
      grid-template-columns: 1fr;
    }
  }
</style>


<!-- ==========================================================================
     Scripts — Interactive Quiz + IntersectionObserver
     ========================================================================== -->
<script>
  /* --------------------------------------------------------------------------
     Scenario Quiz — 10 questions on taxis and kinesis
     Two-step format: (1) taxis or kinesis? (2) what specific type?
     -------------------------------------------------------------------------- */
  const questions = [
    {
      scenario: 'A woodlouse moves faster when the air around it is dry, and slows down when it reaches a humid area under a log.',
      isTaxis: false,
      specificType: 'Orthokinesis',
      followUpOptions: ['Orthokinesis', 'Klinokinesis'],
      explanation: 'The woodlouse changes its speed (not direction) based on humidity. It cannot detect which direction is damper — it just moves quickly until it finds a moist spot, then slows down. This is orthokinesis.'
    },
    {
      scenario: 'A blowfly maggot swings its head from side to side, then crawls directly away from a beam of light.',
      isTaxis: true,
      specificType: 'Negative phototaxis (klinotaxis)',
      followUpOptions: ['Positive phototaxis', 'Negative phototaxis (klinotaxis)', 'Positive chemotaxis', 'Negative thermotaxis'],
      explanation: 'The maggot detects light direction by comparing intensity as it swings its head (klinotaxis) and moves away from the light source — negative phototaxis. This appeared in the 2015 NCEA exam.'
    },
    {
      scenario: 'Pāua (abalone) larvae in NZ coastal waters swim towards chemicals released by coralline algae on nearby rocks.',
      isTaxis: true,
      specificType: 'Positive chemotaxis',
      followUpOptions: ['Positive phototaxis', 'Positive chemotaxis', 'Positive rheotaxis', 'Negative chemotaxis'],
      explanation: 'The larvae detect the direction of the chemical gradient and swim towards it — positive chemotaxis. This ensures they settle on suitable substrate near adult feeding habitat.'
    },
    {
      scenario: 'A flatworm in a Petri dish changes direction frequently under a bright lamp, but moves in fairly straight lines when the light is dimmed.',
      isTaxis: false,
      specificType: 'Klinokinesis',
      followUpOptions: ['Orthokinesis', 'Klinokinesis'],
      explanation: 'The rate of turning changes with light intensity — the flatworm turns more in bright light and less in dim light. It cannot detect which direction is darker. This is klinokinesis.'
    },
    {
      scenario: 'At night, midges and moths fly directly towards the blue-green glow of a New Zealand glow-worm (Arachnocampa luminosa) in a Waitomo cave.',
      isTaxis: true,
      specificType: 'Positive phototaxis',
      followUpOptions: ['Positive phototaxis', 'Negative phototaxis (klinotaxis)', 'Positive chemotaxis', 'Positive trophotaxis'],
      explanation: 'The insects detect the direction of the bioluminescent light and fly straight towards it — positive phototaxis. The glow-worm exploits this innate response to catch prey.'
    },
    {
      scenario: 'Research at Maungatautari found that tree wētā were 87.5% less active in areas with artificial LED lighting. Males almost completely avoided illuminated sites.',
      isTaxis: true,
      specificType: 'Negative phototaxis',
      followUpOptions: ['Positive phototaxis', 'Negative phototaxis', 'Negative thermotaxis', 'Positive chemotaxis'],
      explanation: 'Wētā detect the direction of the light and move away from it — negative phototaxis. This protects them from predators during nocturnal foraging.'
    },
    {
      scenario: 'A peripatus (ngaokeoke) in NZ bush scrambles quickly across open, dry ground but slows right down when it reaches damp leaf litter.',
      isTaxis: false,
      specificType: 'Orthokinesis',
      followUpOptions: ['Orthokinesis', 'Klinokinesis'],
      explanation: 'The peripatus changes its speed based on humidity — faster in dry conditions, slower in damp. It cannot detect which direction is damper. This is orthokinesis (hygrokinesis), and it is critical for survival since peripatus cannot close their breathing pores.'
    },
    {
      scenario: 'A young longfin eel (tuna) swims against the river current as it migrates from the sea into NZ freshwater streams.',
      isTaxis: true,
      specificType: 'Positive rheotaxis',
      followUpOptions: ['Positive phototaxis', 'Positive chemotaxis', 'Positive rheotaxis', 'Negative hydrotaxis'],
      explanation: 'The eel detects the direction of water flow and swims against it — positive rheotaxis. This innate response drives the upstream migration from ocean to freshwater.'
    },
    {
      scenario: 'A barnacle larva uses receptors on both sides of its body to detect chemicals from an established colony, and swims towards the source.',
      isTaxis: true,
      specificType: 'Positive chemotaxis (tropotaxis)',
      followUpOptions: ['Positive phototaxis', 'Positive chemotaxis (tropotaxis)', 'Positive rheotaxis', 'Positive thermotaxis'],
      explanation: 'The larva makes a simultaneous comparison of chemical concentration on both sides (tropotaxis) and moves towards the higher concentration — positive chemotaxis. This appeared in the 2015 NCEA exam.'
    },
    {
      scenario: 'Cave wētā in a damp cave move slowly and in straight lines. When placed on dry ground in daylight, they move rapidly and change direction frequently.',
      isTaxis: false,
      specificType: 'Orthokinesis + klinokinesis',
      followUpOptions: ['Orthokinesis only', 'Klinokinesis only', 'Orthokinesis + klinokinesis'],
      explanation: 'Both the speed (orthokinesis) and the turning rate (klinokinesis) change. In unfavourable conditions the wētā moves faster and turns more often. In favourable conditions it slows down and moves straighter — spending more time in damp, dark habitats.'
    }
  ];

  /* State */
  let currentQuestion = 0;
  let score = 0;
  let phase = 'idle'; /* idle | step1 | step2 | feedback */
  const results = [];

  /* DOM references */
  const startEl = document.getElementById('quiz-start');
  const startBtn = document.getElementById('quiz-start-btn');
  const activeEl = document.getElementById('quiz-active');
  const scenarioEl = document.getElementById('quiz-scenario');
  const optionsEl = document.getElementById('quiz-options');
  const feedbackEl = document.getElementById('quiz-feedback');
  const nextBtn = document.getElementById('quiz-next');
  const progressFill = document.getElementById('quiz-progress-fill');
  const qNumEl = document.getElementById('q-num');
  const qTotalEl = document.getElementById('q-total');
  const resultsEl = document.getElementById('quiz-results');
  const scoreNumEl = document.getElementById('quiz-score-number');
  const scoreTotalEl = document.getElementById('quiz-score-total');
  const scoreLabelEl = document.getElementById('quiz-score-label');
  const reviewEl = document.getElementById('quiz-review');
  const restartBtn = document.getElementById('quiz-restart-btn');

  if (startBtn && qTotalEl) {
    qTotalEl.textContent = String(questions.length);
    scoreTotalEl.textContent = String(questions.length * 2);
  }

  /* Shuffle questions for variety */
  function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  function startQuiz() {
    shuffle(questions);
    currentQuestion = 0;
    score = 0;
    results.length = 0;
    startEl.hidden = true;
    resultsEl.hidden = true;
    activeEl.hidden = false;
    showQuestion();
  }

  function showQuestion() {
    const q = questions[currentQuestion];
    phase = 'step1';

    qNumEl.textContent = String(currentQuestion + 1);
    progressFill.style.width = `${((currentQuestion) / questions.length) * 100}%`;
    scenarioEl.textContent = q.scenario;

    feedbackEl.hidden = true;
    feedbackEl.className = 'quiz-feedback';
    nextBtn.hidden = true;

    /* Step 1: Taxis or Kinesis? */
    optionsEl.innerHTML = '';
    ['Taxis', 'Kinesis'].forEach(label => {
      const btn = document.createElement('button');
      btn.className = 'quiz-option-btn';
      btn.textContent = label;
      btn.addEventListener('click', () => handleStep1(label));
      optionsEl.appendChild(btn);
    });
  }

  function handleStep1(answer) {
    const q = questions[currentQuestion];
    const correct = (answer === 'Taxis') === q.isTaxis;

    /* Disable buttons and show correct/incorrect */
    optionsEl.querySelectorAll('.quiz-option-btn').forEach(btn => {
      btn.disabled = true;
      const isCorrectLabel = (btn.textContent === 'Taxis') === q.isTaxis;
      btn.classList.add(isCorrectLabel ? 'correct' : 'incorrect');
    });

    if (correct) {
      score++;
      /* Move to step 2 */
      phase = 'step2';
      feedbackEl.innerHTML = '<strong>Correct!</strong> Now — what specific type is this?';
      feedbackEl.className = 'quiz-feedback correct';
      feedbackEl.hidden = false;

      /* Show follow-up options after a brief pause */
      setTimeout(() => {
        optionsEl.innerHTML = '';
        q.followUpOptions.forEach(label => {
          const btn = document.createElement('button');
          btn.className = 'quiz-option-btn';
          btn.textContent = label;
          btn.addEventListener('click', () => handleStep2(label));
          optionsEl.appendChild(btn);
        });
        feedbackEl.hidden = true;
      }, 800);
    } else {
      /* Wrong — show explanation and move on */
      results.push({ scenario: q.scenario, gotStep1: false, gotStep2: false });
      feedbackEl.innerHTML = `<strong>Not quite.</strong> ${q.explanation}`;
      feedbackEl.className = 'quiz-feedback incorrect';
      feedbackEl.hidden = false;
      nextBtn.hidden = false;
      phase = 'feedback';
    }
  }

  function handleStep2(answer) {
    const q = questions[currentQuestion];
    const correct = answer === q.specificType;

    optionsEl.querySelectorAll('.quiz-option-btn').forEach(btn => {
      btn.disabled = true;
      if (btn.textContent === q.specificType) {
        btn.classList.add('correct');
      } else if (btn.textContent === answer && !correct) {
        btn.classList.add('incorrect');
      }
    });

    if (correct) {
      score++;
      results.push({ scenario: q.scenario, gotStep1: true, gotStep2: true });
      feedbackEl.innerHTML = `<strong>Excellent!</strong> ${q.explanation}`;
      feedbackEl.className = 'quiz-feedback correct';
    } else {
      results.push({ scenario: q.scenario, gotStep1: true, gotStep2: false });
      feedbackEl.innerHTML = `<strong>Close — you got taxis/kinesis right.</strong> ${q.explanation}`;
      feedbackEl.className = 'quiz-feedback incorrect';
    }

    feedbackEl.hidden = false;
    nextBtn.hidden = false;
    phase = 'feedback';
  }

  function nextQuestion() {
    currentQuestion++;
    if (currentQuestion >= questions.length) {
      showResults();
    } else {
      showQuestion();
    }
  }

  function showResults() {
    activeEl.hidden = true;
    resultsEl.hidden = false;
    progressFill.style.width = '100%';

    scoreNumEl.textContent = String(score);
    const pct = Math.round((score / (questions.length * 2)) * 100);

    if (pct >= 90) scoreLabelEl.textContent = 'Outstanding — Excellence level understanding!';
    else if (pct >= 70) scoreLabelEl.textContent = 'Great work — solid Merit-level knowledge.';
    else if (pct >= 50) scoreLabelEl.textContent = 'Good start — review the core content to level up.';
    else scoreLabelEl.textContent = 'Keep going — re-read the taxis and kinesis sections above, then try again.';

    /* Build review list */
    reviewEl.innerHTML = '';
    results.forEach((r, i) => {
      const div = document.createElement('div');
      div.className = 'quiz-review-item';
      const allCorrect = r.gotStep1 && r.gotStep2;
      const partial = r.gotStep1 && !r.gotStep2;
      const colour = allCorrect ? 'green' : 'red';
      const label = allCorrect ? '2/2' : partial ? '1/2' : '0/2';
      div.innerHTML = `<span class="dot ${colour}"></span><span>Q${i + 1}: ${label}</span>`;
      reviewEl.appendChild(div);
    });
  }

  /* Event listeners */
  if (startBtn) startBtn.addEventListener('click', startQuiz);
  if (nextBtn) nextBtn.addEventListener('click', nextQuestion);
  if (restartBtn) restartBtn.addEventListener('click', startQuiz);


  /* --------------------------------------------------------------------------
     Audio Playback — "How to Watch" narration
     -------------------------------------------------------------------------- */
  (function initAudio() {
    const btn = document.getElementById('how-to-watch-audio');
    if (!btn) return;

    let audio = null;

    btn.addEventListener('click', () => {
      // If already playing, pause
      if (audio && !audio.paused) {
        audio.pause();
        btn.textContent = '\u25B6';
        btn.classList.remove('playing');
        return;
      }

      // If paused mid-way, resume
      if (audio && audio.paused && audio.currentTime > 0) {
        audio.play();
        btn.textContent = '\u23F8\uFE0E';
        btn.classList.add('playing');
        return;
      }

      // Start fresh
      // Astro base path is /biology-level3 — audio lives in public/audio/
      audio = new Audio('/biology-level3/audio/how_to_watch.mp3');
      btn.textContent = '\u23F8\uFE0E';
      btn.classList.add('playing');
      audio.play();

      audio.addEventListener('ended', () => {
        btn.textContent = '\u25B6';
        btn.classList.remove('playing');
        audio = null;
      });

      audio.addEventListener('error', () => {
        btn.textContent = '\u25B6';
        btn.classList.remove('playing');
        audio = null;
      });
    });
  })();


  /* --------------------------------------------------------------------------
     IntersectionObserver — triggers .fade-in-up animations on viewport entry
     -------------------------------------------------------------------------- */
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.08, rootMargin: '0px 0px -40px 0px' }
  );

  document.querySelectorAll('.fade-in-up').forEach((el) => observer.observe(el));
</script>
